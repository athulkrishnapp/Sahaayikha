{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h2 class="mb-4">System Settings</h2>
  <div class="table-responsive">
    <table class="table table-striped table-bordered align-middle">
      <thead class="table-dark">
        <tr>
          <th>Setting Key</th>
          <th>Value</th>
          <th>Last Updated</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for setting in settings %}
        <tr>
          <td>{{ setting.key }}</td>
          <td>{{ setting.value }}</td>
          <td>{{ setting.updated_at.strftime('%Y-%m-%d %H:%M') }}</td>
          <td>
            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#editSettingModal{{ setting.setting_id }}">
              Edit
            </button>

            <div class="modal fade" id="editSettingModal{{ setting.setting_id }}" tabindex="-1" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <form method="POST" action="{{ url_for('main.update_setting', setting_id=setting.setting_id) }}">
                    <div class="modal-header">
                      <h5 class="modal-title">Edit {{ setting.key }}</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <input type="text" name="value" class="form-control" value="{{ setting.value }}">
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                      <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="text-center text-muted">No settings found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}